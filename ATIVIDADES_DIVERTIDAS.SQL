--ATIVIDADE-1

UPDATE DEBITOS d  SET d.SITUACAO_DEBITO = 'Atrasado'
WHERE d.SITUACAO_DEBITO NOT IN ('Negociando', 'Pago' ) AND CURRENT_DATE > DATAVENCIMENTO  

--ATIVIDADE-2

UPDATE DEBITOS d  SET d.SITUACAO_DEBITO = 'Pendente'
WHERE d.SITUACAO_DEBITO NOT IN ('Pago' ) AND CURRENT_DATE > DATAVENCIMENTO   

--ATIVIDADE-3

UPDATE DEBITOS d SET DATAVENCIMENTO = DATEADD (YEAR, -5 ,DATAVENCIMENTO)
WHERE D.SITUACAO_DEBITO = 'Negociando'

--ATIVIDADE-4

SELECT P.NOME 
	 , P.EMAIL 
	 , P.TELEFONE 
FROM PESSOA p 

--ATIVIDADE-5

SELECT P.NOME 
	 , P.PRECO_UNITARIO 
FROM   PRODUTO p 
WHERE  P.PRECO_UNITARIO > 100

--ATIVIDADE-6

SELECT V.ID_VENDA 
	 , V.DATA_VENDA	
FROM   VENDA v 
WHERE  V.DATA_VENDA = '2022-05-02'

--ATIVIDADE-7

SELECT P.ID_FORNECEDOR 
	 , P2.NOME 
	 , EXTRACT (YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM P2.DATA_NASCIMENTO) AS IDADE
	 , P.QUANTIDADE_ESTOQUE
FROM PRODUTO p 
INNER JOIN FORNECEDOR F ON F.ID_FORNECEDOR = P.ID_FORNECEDOR 
LEFT JOIN PESSOA P2 ON P2.ID_PESSOA = F.ID_PESSOA 
WHERE P.QUANTIDADE_ESTOQUE = 0
OR P.ID_PRODUTO IS NULL 

INSERT INTO PESSOA (ID_PESSOA ,NOME, EMAIL, TELEFONE, DATA_NASCIMENTO)
VALUES ('55','Enzo', 'enzo.carvalho@gmail.com', '998237788', '1998-07-15');

INSERT INTO FORNECEDOR (ID_FORNECEDOR,ID_PESSOA,CNPJ)
VALUES ('51', '55' ,'97534628645365')

--ATIVIDADE-8

SELECT P.NOME 
	 , P.EMAIL 
	 , P.TELEFONE 
FROM PESSOA p 
INNER JOIN CLIENTE c  ON C.ID_PESSOA = P.ID_PESSOA 
INNER JOIN DEBITOS d  ON D.ID_CLIENTE = C.ID_CLIENTE 
WHERE D.DATAVENCIMENTO < CURRENT_DATE 
AND D.ID_DEBITO NOT IN (SELECT PG.ID_DEBITO  FROM PAGAMENTO PG WHERE PG.ID_DEBITO = D.ID_DEBITO)

--ATIVIDADE-9



--ATIVIDADE-10

UPDATE PRODUTO P
SET P.PRECO_UNITARIO =P.PRECO_UNITARIO *0.1
WHERE P.QUANTIDADE_ESTOQUE < 10

--ATIVIDADE-12



--ATIVIDADE-13

SELECT P.DATA_PAGAMENTO 
FROM PAGAMENTO p 
WHERE p.DATA_PAGAMENTO BETWEEN '2023-12-01' AND '2024-01-01'

--ATIVIDADE-14

SELECT P.NOME 
	 , P.QUANTIDADE_ESTOQUE 
FROM PRODUTO p 
WHERE P.QUANTIDADE_ESTOQUE BETWEEN '5' AND '20'

--ATIVIDADE-15

SELECT P.NOME 
FROM PESSOA P 
WHERE P.NOME LIKE 'A%'

--ATIVIDADE-16

SELECT P.NOME 
	 , P.ID_PRODUTO 
	 , P.PRECO_UNITARIO 
FROM PRODUTO p 
WHERE P.ID_PRODUTO NOT IN (SELECT P.ID_PRODUTO FROM ITENSVENDA i)

--ATIVIDADE-17

SELECT P.NOME 
	 , 
FROM CLIENTE c 
INNER JOIN PESSOA p ON P.ID_PESSOA = C.ID_PESSOA 
INNER JOIN ITENSVENDA i ON I